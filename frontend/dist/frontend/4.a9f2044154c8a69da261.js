(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"2Xbf":function(e,t,n){"use strict";n.d(t,"a",function(){return g});var i=n("XNiG"),r=n("SxV6"),o=n("1G5W"),s=n("v2jn"),l=n("dCgF"),a=n("fXoL"),u=n("OaWH");let c=(()=>{class e{constructor(e){this.appService=e}get initialized(){return void 0!==this.ytext}createText(e,t){this.ytext=this.appService.ydoc.getText(e),this.undoManager=new l.b(this.ytext);const n=this.ytext.toString();return this.previousState=n||t,n}registerObserver(e){this.ytext.observe((t,n)=>{const i=this.ytext.toString();e(i,t.delta)})}applyDeltaToCurrent(e,t){this.checkInitialized();let n=0,i=t.txt,r=t.selectionStart,o=t.selectionEnd;const s=void 0!==r&&void 0!==o;for(const l of e)l.retain?n+=l.retain:l.insert?(i=i.slice(0,n)+l.insert+i.slice(n),n+=l.insert.length,s&&(n<r&&(r+=l.insert.length),n<o&&(o+=l.insert.length))):l.delete&&(i=i.slice(0,n)+i.slice(n+l.delete),s&&(n<r&&(r-=l.delete),n<o&&(o-=l.delete)));return this.previousState=i,{txt:i,selectionStart:r,selectionEnd:o}}onTextChange(e){try{this.checkInitialized()}catch(t){return}if(void 0===this.previousState||this.previousState!==e){console.log({txt:e},"text on change");const t=Object(s.diffChars)(this.previousState||"",e);let n=0;for(const e of t)e.added?this.ytext.insert(n,e.value):e.removed&&this.ytext.delete(n,e.value.length),n+=e.count;this.previousState=e}}undo(){this.checkInitialized(),this.undoManager.undo()}redo(){this.checkInitialized(),this.undoManager.redo()}checkInitialized(){if(!this.initialized)throw new Error("ytext is not initialized")}}return e.\u0275fac=function(t){return new(t||e)(a.Wb(u.a))},e.\u0275prov=a.Ib({token:e,factory:e.\u0275fac}),e})();var d=n("bTqV"),f=n("3Pt+");const h=["subtitle_TextArea"],p=["left","right","both"];let g=(()=>{class e{constructor(e,t,n){this.cd=e,this.ngZone=t,this.crdtTextService=n,this.inputArea="",this.outputArea="",this.layout="both",this.unsubscriber$=new i.b,this.inputArea=this.getInput();const s=this.crdtTextService.createText("test",this.inputArea);this.inputArea=s||this.inputArea,this.cd.markForCheck(),this.crdtTextService.registerObserver((e,t)=>{var n,i,s,l;if(e===this.inputArea)return;const a=this.crdtTextService.applyDeltaToCurrent(t,{txt:this.inputArea,selectionStart:null===(i=null===(n=this.inputAreaElm)||void 0===n?void 0:n.nativeElement)||void 0===i?void 0:i.selectionStart,selectionEnd:null===(l=null===(s=this.inputAreaElm)||void 0===s?void 0:s.nativeElement)||void 0===l?void 0:l.selectionEnd});this.inputArea=a.txt,this.cd.markForCheck(),void 0!==a.selectionStart&&void 0!==a.selectionEnd&&this.ngZone.onStable.pipe(Object(r.a)(),Object(o.a)(this.unsubscriber$)).subscribe(()=>{this.inputAreaElm.nativeElement.setSelectionRange(a.selectionStart,a.selectionEnd)})})}getInput(){return localStorage.getItem(e.subtitleLocalStorageKey)||""}undo(){this.crdtTextService.undo()}redo(){this.crdtTextService.redo()}ngOnInit(){}ngOnDestroy(){this.unsubscriber$.next()}ngDoCheck(){this.crdtTextService.onTextChange(this.inputArea)}generateSubtitle(){const t=this.inputArea;localStorage.setItem(e.subtitleLocalStorageKey,t);const n=this.formatSubtitle(t);this.outputArea=n,this.cd.markForCheck()}applyLayout(e){p.includes(e)&&(this.layout=e,this.cd.markForCheck())}formatSubtitle(e){e=(e=(e=(e=e.replace(/[\(|\uff08].*[\)|\uff09]/g,"")).replace(/\n{3,}/g,"\n\n")).replace(/\u3001/g,"\u3001\n")).replace(/\u3002/g,"\u3002\n");const t="-".repeat(20);return(e=e.replace(/\n(\d+_\d+)\n/g,(e,n)=>`\n${t}${n}${t}\n`)).replace(/\n(\d+)\n/g,(e,n)=>`\n${t}${n}${t}\n`)}}return e.subtitleLocalStorageKey="subtitleLocalStorageKey",e.\u0275fac=function(t){return new(t||e)(a.Mb(a.h),a.Mb(a.A),a.Mb(c))},e.\u0275cmp=a.Gb({type:e,selectors:[["app-subtitle"]],viewQuery:function(e,t){if(1&e&&a.Dc(h,1),2&e){let e;a.nc(e=a.ac())&&(t.inputAreaElm=e.first)}},features:[a.Ab([c])],decls:24,vars:13,consts:[[1,"subtitle_Wrapper"],["mat-stroked-button","","color","primary","type","button",1,"subtitle_MainButton",3,"click"],["mat-raised-button","",3,"click"],[1,"subtitle_Layout_Buttons"],["mat-stroked-button","","color","primary",3,"disabled","click"],[1,"subtitle_Inner"],[1,"subtitle_Labels"],[1,"subtitle_TextAreas"],["placeholder","paste subtitle here",1,"subtitle_TextArea","left",3,"ngModel","ngModelChange"],["subtitle_TextArea",""],[1,"subtitle_TextArea","right",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(a.Sb(0,"div",0),a.Sb(1,"button",1),a.Zb("click",function(){return t.generateSubtitle()}),a.zc(2," generate subtitle "),a.Rb(),a.Sb(3,"button",2),a.Zb("click",function(){return t.undo()}),a.zc(4,"undo"),a.Rb(),a.Sb(5,"button",2),a.Zb("click",function(){return t.redo()}),a.zc(6,"redo"),a.Rb(),a.Sb(7,"div",3),a.Sb(8,"button",4),a.Zb("click",function(){return t.applyLayout("left")}),a.zc(9," input "),a.Rb(),a.Sb(10,"button",4),a.Zb("click",function(){return t.applyLayout("right")}),a.zc(11," output "),a.Rb(),a.Sb(12,"button",4),a.Zb("click",function(){return t.applyLayout("both")}),a.zc(13," both "),a.Rb(),a.Rb(),a.Sb(14,"div",5),a.Sb(15,"div",6),a.Sb(16,"label"),a.zc(17,"input"),a.Rb(),a.Sb(18,"label"),a.zc(19,"output"),a.Rb(),a.Rb(),a.Sb(20,"div",7),a.Sb(21,"textarea",8,9),a.Zb("ngModelChange",function(e){return t.inputArea=e}),a.Rb(),a.Sb(23,"textarea",10),a.Zb("ngModelChange",function(e){return t.outputArea=e}),a.Rb(),a.Rb(),a.Rb(),a.Rb()),2&e&&(a.Bb(8),a.jc("disabled","left"===t.layout),a.Bb(2),a.jc("disabled","right"===t.layout),a.Bb(2),a.jc("disabled","both"===t.layout),a.Bb(4),a.Eb("hide","right"===t.layout),a.Bb(2),a.Eb("hide","left"===t.layout),a.Bb(3),a.Eb("hide","right"===t.layout),a.jc("ngModel",t.inputArea),a.Bb(2),a.Eb("hide","left"===t.layout),a.jc("ngModel",t.outputArea))},directives:[d.b,f.c,f.n,f.q],styles:["body[_ngcontent-%COMP%], html[_ngcontent-%COMP%]{height:100%}body[_ngcontent-%COMP%]{margin:0;font-family:Roboto,Helvetica Neue,sans-serif}.subtitle_Wrapper[_ngcontent-%COMP%]{max-width:1080px;margin:0 auto;padding:0 30px;width:100%;max-width:none}.subtitle_Wrapper[_ngcontent-%COMP%]   .subtitle_MainButton[_ngcontent-%COMP%]{margin:20px;height:50px;width:500px}.subtitle_Wrapper[_ngcontent-%COMP%]   .subtitle_Layout_Buttons[_ngcontent-%COMP%]{margin:20px}.subtitle_Wrapper[_ngcontent-%COMP%]   .subtitle_Layout_Buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:300px;height:50px}.subtitle_Wrapper[_ngcontent-%COMP%]   .subtitle_Inner[_ngcontent-%COMP%]   .subtitle_Labels[_ngcontent-%COMP%]{display:flex;width:100%}.subtitle_Wrapper[_ngcontent-%COMP%]   .subtitle_Inner[_ngcontent-%COMP%]   .subtitle_Labels[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{flex-grow:1;font-size:30px;margin:10px 30px}.subtitle_Wrapper[_ngcontent-%COMP%]   .subtitle_Inner[_ngcontent-%COMP%]   .subtitle_TextAreas[_ngcontent-%COMP%]{display:flex;width:100%}.subtitle_Wrapper[_ngcontent-%COMP%]   .subtitle_Inner[_ngcontent-%COMP%]   .subtitle_TextAreas[_ngcontent-%COMP%]   .subtitle_TextArea[_ngcontent-%COMP%]{height:1000px;margin:0 20px;flex-grow:1}.hide[_ngcontent-%COMP%]{display:none}"],changeDetection:0}),e})()},v2jn:function(e,t,n){!function(e){"use strict";function t(){}function n(e,t,n,i,r){for(var o=0,s=t.length,l=0,a=0;o<s;o++){var u=t[o];if(u.removed){if(u.value=e.join(i.slice(a,a+u.count)),a+=u.count,o&&t[o-1].added){var c=t[o-1];t[o-1]=t[o],t[o]=c}}else{if(!u.added&&r){var d=n.slice(l,l+u.count);d=d.map(function(e,t){var n=i[a+t];return n.length>e.length?n:e}),u.value=e.join(d)}else u.value=e.join(n.slice(l,l+u.count));l+=u.count,u.added||(a+=u.count)}}var f=t[s-1];return s>1&&"string"==typeof f.value&&(f.added||f.removed)&&e.equals("",f.value)&&(t[s-2].value+=f.value,t.pop()),t}function i(e){return{newPos:e.newPos,components:e.components.slice(0)}}t.prototype={diff:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.callback;"function"==typeof r&&(o=r,r={}),this.options=r;var s=this;function l(e){return o?(setTimeout(function(){o(void 0,e)},0),!0):e}e=this.castInput(e),t=this.castInput(t),e=this.removeEmpty(this.tokenize(e));var a=(t=this.removeEmpty(this.tokenize(t))).length,u=e.length,c=1,d=a+u,f=[{newPos:-1,components:[]}],h=this.extractCommon(f[0],t,e,0);if(f[0].newPos+1>=a&&h+1>=u)return l([{value:this.join(t),count:t.length}]);function p(){for(var r=-1*c;r<=c;r+=2){var o=void 0,d=f[r-1],h=f[r+1],p=(h?h.newPos:0)-r;d&&(f[r-1]=void 0);var g=d&&d.newPos+1<a,v=h&&0<=p&&p<u;if(g||v){if(!g||v&&d.newPos<h.newPos?(o=i(h),s.pushComponent(o.components,void 0,!0)):((o=d).newPos++,s.pushComponent(o.components,!0,void 0)),p=s.extractCommon(o,t,e,r),o.newPos+1>=a&&p+1>=u)return l(n(s,o.components,t,e,s.useLongestToken));f[r]=o}else f[r]=void 0}c++}if(o)!function e(){setTimeout(function(){if(c>d)return o();p()||e()},0)}();else for(;c<=d;){var g=p();if(g)return g}},pushComponent:function(e,t,n){var i=e[e.length-1];i&&i.added===t&&i.removed===n?e[e.length-1]={count:i.count+1,added:t,removed:n}:e.push({count:1,added:t,removed:n})},extractCommon:function(e,t,n,i){for(var r=t.length,o=n.length,s=e.newPos,l=s-i,a=0;s+1<r&&l+1<o&&this.equals(t[s+1],n[l+1]);)s++,l++,a++;return a&&e.components.push({count:a}),e.newPos=s,l},equals:function(e,t){return this.options.comparator?this.options.comparator(e,t):e===t||this.options.ignoreCase&&e.toLowerCase()===t.toLowerCase()},removeEmpty:function(e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};var r=new t;function o(e,t){if("function"==typeof e)t.callback=e;else if(e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var s=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,l=/\S/,a=new t;a.equals=function(e,t){return this.options.ignoreCase&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t||this.options.ignoreWhitespace&&!l.test(e)&&!l.test(t)},a.tokenize=function(e){for(var t=e.split(/(\s+|[()[\]{}'"]|\b)/),n=0;n<t.length-1;n++)!t[n+1]&&t[n+2]&&s.test(t[n])&&s.test(t[n+2])&&(t[n]+=t[n+2],t.splice(n+1,2),n--);return t};var u=new t;function c(e,t,n){return u.diff(e,t,n)}u.tokenize=function(e){var t=[],n=e.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(var i=0;i<n.length;i++){var r=n[i];i%2&&!this.options.newlineIsToken?t[t.length-1]+=r:(this.options.ignoreWhitespace&&(r=r.trim()),t.push(r))}return t};var d=new t;d.tokenize=function(e){return e.split(/(\S.+?[.!?])(?=\s+|$)/)};var f=new t;function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}f.tokenize=function(e){return e.split(/([{}:;,]|\s+)/)};var g=Object.prototype.toString,v=new t;function b(e,t,n,i,r){var o,s;for(t=t||[],n=n||[],i&&(e=i(r,e)),o=0;o<t.length;o+=1)if(t[o]===e)return n[o];if("[object Array]"===g.call(e)){for(t.push(e),s=new Array(e.length),n.push(s),o=0;o<e.length;o+=1)s[o]=b(e[o],t,n,i,r);return t.pop(),n.pop(),s}if(e&&e.toJSON&&(e=e.toJSON()),"object"===h(e)&&null!==e){t.push(e),n.push(s={});var l,a=[];for(l in e)e.hasOwnProperty(l)&&a.push(l);for(a.sort(),o=0;o<a.length;o+=1)s[l=a[o]]=b(e[l],t,n,i,l);t.pop(),n.pop()}else s=e;return s}v.useLongestToken=!0,v.tokenize=u.tokenize,v.castInput=function(e){var t=this.options,n=t.undefinedReplacement,i=t.stringifyReplacer,r=void 0===i?function(e,t){return void 0===t?n:t}:i;return"string"==typeof e?e:JSON.stringify(b(e,null,null,r),r,"  ")},v.equals=function(e,n){return t.prototype.equals.call(v,e.replace(/,([\r\n])/g,"$1"),n.replace(/,([\r\n])/g,"$1"))};var m=new t;function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.split(/\r\n|[\n\v\f\r\x85]/),i=e.match(/\r\n|[\n\v\f\r\x85]/g)||[],r=[],o=0;function s(){var e={};for(r.push(e);o<n.length;){var i=n[o];if(/^(\-\-\-|\+\+\+|@@)\s/.test(i))break;var s=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(i);s&&(e.index=s[1]),o++}for(l(e),l(e),e.hunks=[];o<n.length;){var u=n[o];if(/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(u))break;if(/^@@/.test(u))e.hunks.push(a());else{if(u&&t.strict)throw new Error("Unknown line "+(o+1)+" "+JSON.stringify(u));o++}}}function l(e){var t=/^(---|\+\+\+)\s+(.*)$/.exec(n[o]);if(t){var i="---"===t[1]?"old":"new",r=t[2].split("\t",2),s=r[0].replace(/\\\\/g,"\\");/^".*"$/.test(s)&&(s=s.substr(1,s.length-2)),e[i+"FileName"]=s,e[i+"Header"]=(r[1]||"").trim(),o++}}function a(){for(var e=o,r=n[o++].split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),s={oldStart:+r[1],oldLines:+r[2]||1,newStart:+r[3],newLines:+r[4]||1,lines:[],linedelimiters:[]},l=0,a=0;o<n.length&&!(0===n[o].indexOf("--- ")&&o+2<n.length&&0===n[o+1].indexOf("+++ ")&&0===n[o+2].indexOf("@@"));o++){var u=0==n[o].length&&o!=n.length-1?" ":n[o][0];if("+"!==u&&"-"!==u&&" "!==u&&"\\"!==u)break;s.lines.push(n[o]),s.linedelimiters.push(i[o]||"\n"),"+"===u?l++:"-"===u?a++:" "===u&&(l++,a++)}if(l||1!==s.newLines||(s.newLines=0),a||1!==s.oldLines||(s.oldLines=0),t.strict){if(l!==s.newLines)throw new Error("Added line count did not match for hunk at line "+(e+1));if(a!==s.oldLines)throw new Error("Removed line count did not match for hunk at line "+(e+1))}return s}for(;o<n.length;)s();return r}function y(e,t,n){var i=!0,r=!1,o=!1,s=1;return function l(){if(i&&!o){if(r?s++:i=!1,e+s<=n)return s;o=!0}if(!r)return o||(i=!0),t<=e-s?-s++:(r=!0,l())}}function x(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"==typeof t&&(t=w(t)),Array.isArray(t)){if(t.length>1)throw new Error("applyPatch only works with a single input.");t=t[0]}var i,r,o=e.split(/\r\n|[\n\v\f\r\x85]/),s=e.match(/\r\n|[\n\v\f\r\x85]/g)||[],l=t.hunks,a=n.compareLine||function(e,t,n,i){return t===i},u=0,c=n.fuzzFactor||0,d=0,f=0;function h(e,t){for(var n=0;n<e.lines.length;n++){var i=e.lines[n],r=i.length>0?i[0]:" ",s=i.length>0?i.substr(1):i;if(" "===r||"-"===r){if(!a(t+1,o[t],r,s)&&++u>c)return!1;t++}}return!0}for(var p=0;p<l.length;p++){for(var g=l[p],v=0,b=f+g.oldStart-1,m=y(b,d,o.length-g.oldLines);void 0!==v;v=m())if(h(g,b+v)){g.offset=f+=v;break}if(void 0===v)return!1;d=g.offset+g.oldStart+g.oldLines}for(var x=0,S=0;S<l.length;S++){var L=l[S],k=L.oldStart+L.offset+x-1;x+=L.newLines-L.oldLines,k<0&&(k=0);for(var _=0;_<L.lines.length;_++){var C=L.lines[_],P=C.length>0?C[0]:" ",M=C.length>0?C.substr(1):C,O=L.linedelimiters[_];if(" "===P)k++;else if("-"===P)o.splice(k,1),s.splice(k,1);else if("+"===P)o.splice(k,0,M),s.splice(k,0,O),k++;else if("\\"===P){var A=L.lines[_-1]?L.lines[_-1][0]:null;"+"===A?i=!0:"-"===A&&(r=!0)}}}if(i)for(;!o[o.length-1];)o.pop(),s.pop();else r&&(o.push(""),s.push("\n"));for(var F=0;F<o.length-1;F++)o[F]=o[F]+s[F];return o.join("")}function S(e,t,n,i,r,o,s){s||(s={}),void 0===s.context&&(s.context=4);var l=c(n,i,s);function a(e){return e.map(function(e){return" "+e})}l.push({value:"",lines:[]});for(var u=[],d=0,f=0,h=[],g=1,v=1,b=function(e){var t=l[e],r=t.lines||t.value.replace(/\n$/,"").split("\n");if(t.lines=r,t.added||t.removed){var o;if(!d){var c=l[e-1];d=g,f=v,c&&(h=s.context>0?a(c.lines.slice(-s.context)):[],d-=h.length,f-=h.length)}(o=h).push.apply(o,p(r.map(function(e){return(t.added?"+":"-")+e}))),t.added?v+=r.length:g+=r.length}else{if(d)if(r.length<=2*s.context&&e<l.length-2){var b;(b=h).push.apply(b,p(a(r)))}else{var m,w=Math.min(r.length,s.context);(m=h).push.apply(m,p(a(r.slice(0,w))));var y={oldStart:d,oldLines:g-d+w,newStart:f,newLines:v-f+w,lines:h};if(e>=l.length-2&&r.length<=s.context){var x=/\n$/.test(n),S=/\n$/.test(i),L=0==r.length&&h.length>y.oldLines;!x&&L&&h.splice(y.oldLines,0,"\\ No newline at end of file"),(x||L)&&S||h.push("\\ No newline at end of file")}u.push(y),d=0,f=0,h=[]}g+=r.length,v+=r.length}},m=0;m<l.length;m++)b(m);return{oldFileName:e,newFileName:t,oldHeader:r,newHeader:o,hunks:u}}function L(e,t,n,i,r,o,s){var l=S(e,t,n,i,r,o,s),a=[];e==t&&a.push("Index: "+e),a.push("==================================================================="),a.push("--- "+l.oldFileName+(void 0===l.oldHeader?"":"\t"+l.oldHeader)),a.push("+++ "+l.newFileName+(void 0===l.newHeader?"":"\t"+l.newHeader));for(var u=0;u<l.hunks.length;u++){var c=l.hunks[u];a.push("@@ -"+c.oldStart+","+c.oldLines+" +"+c.newStart+","+c.newLines+" @@"),a.push.apply(a,c.lines)}return a.join("\n")+"\n"}function k(e,t){if(t.length>e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function _(e){var t=W(e.lines),n=t.oldLines,i=t.newLines;void 0!==n?e.oldLines=n:delete e.oldLines,void 0!==i?e.newLines=i:delete e.newLines}function C(e,t){if("string"==typeof e){if(/^@@/m.test(e)||/^Index:/m.test(e))return w(e)[0];if(!t)throw new Error("Must provide a base reference or pass in a patch");return S(void 0,void 0,t,e)}return e}function P(e){return e.newFileName&&e.newFileName!==e.oldFileName}function M(e,t,n){return t===n?t:(e.conflict=!0,{mine:t,theirs:n})}function O(e,t){return e.oldStart<t.oldStart&&e.oldStart+e.oldLines<t.oldStart}function A(e,t){return{oldStart:e.oldStart,oldLines:e.oldLines,newStart:e.newStart+t,newLines:e.newLines,lines:e.lines}}function F(e,t,n,i,r){var o={offset:t,lines:n,index:0},s={offset:i,lines:r,index:0};for(z(e,o,s),z(e,s,o);o.index<o.lines.length&&s.index<s.lines.length;){var l=o.lines[o.index],a=s.lines[s.index];if("-"!==l[0]&&"+"!==l[0]||"-"!==a[0]&&"+"!==a[0])if("+"===l[0]&&" "===a[0]){var u;(u=e.lines).push.apply(u,p(I(o)))}else if("+"===a[0]&&" "===l[0]){var c;(c=e.lines).push.apply(c,p(I(s)))}else"-"===l[0]&&" "===a[0]?T(e,o,s):"-"===a[0]&&" "===l[0]?T(e,s,o,!0):l===a?(e.lines.push(l),o.index++,s.index++):E(e,I(o),I(s));else N(e,o,s)}j(e,o),j(e,s),_(e)}function N(e,t,n){var i,r,o=I(t),s=I(n);if(H(o)&&H(s)){var l,a;if(k(o,s)&&R(n,o,o.length-s.length))return void(l=e.lines).push.apply(l,p(o));if(k(s,o)&&R(t,s,s.length-o.length))return void(a=e.lines).push.apply(a,p(s))}else if((i=o).length===(r=s).length&&k(i,r)){var u;return void(u=e.lines).push.apply(u,p(o))}E(e,o,s)}function T(e,t,n,i){var r,o=I(t),s=function(e,t){for(var n=[],i=[],r=0,o=!1,s=!1;r<t.length&&e.index<e.lines.length;){var l=e.lines[e.index],a=t[r];if("+"===a[0])break;if(o=o||" "!==l[0],i.push(a),r++,"+"===l[0])for(s=!0;"+"===l[0];)n.push(l),l=e.lines[++e.index];a.substr(1)===l.substr(1)?(n.push(l),e.index++):s=!0}if("+"===(t[r]||"")[0]&&o&&(s=!0),s)return n;for(;r<t.length;)i.push(t[r++]);return{merged:i,changes:n}}(n,o);s.merged?(r=e.lines).push.apply(r,p(s.merged)):E(e,i?s:o,i?o:s)}function E(e,t,n){e.conflict=!0,e.lines.push({conflict:!0,mine:t,theirs:n})}function z(e,t,n){for(;t.offset<n.offset&&t.index<t.lines.length;){var i=t.lines[t.index++];e.lines.push(i),t.offset++}}function j(e,t){for(;t.index<t.lines.length;){var n=t.lines[t.index++];e.lines.push(n)}}function I(e){for(var t=[],n=e.lines[e.index][0];e.index<e.lines.length;){var i=e.lines[e.index];if("-"===n&&"+"===i[0]&&(n="+"),n!==i[0])break;t.push(i),e.index++}return t}function H(e){return e.reduce(function(e,t){return e&&"-"===t[0]},!0)}function R(e,t,n){for(var i=0;i<n;i++){var r=t[t.length-n+i].substr(1);if(e.lines[e.index+i]!==" "+r)return!1}return e.index+=n,!0}function W(e){var t=0,n=0;return e.forEach(function(e){if("string"!=typeof e){var i=W(e.mine),r=W(e.theirs);void 0!==t&&(i.oldLines===r.oldLines?t+=i.oldLines:t=void 0),void 0!==n&&(i.newLines===r.newLines?n+=i.newLines:n=void 0)}else void 0===n||"+"!==e[0]&&" "!==e[0]||n++,void 0===t||"-"!==e[0]&&" "!==e[0]||t++}),{oldLines:t,newLines:n}}m.tokenize=function(e){return e.slice()},m.join=m.removeEmpty=function(e){return e},e.Diff=t,e.diffChars=function(e,t,n){return r.diff(e,t,n)},e.diffWords=function(e,t,n){return n=o(n,{ignoreWhitespace:!0}),a.diff(e,t,n)},e.diffWordsWithSpace=function(e,t,n){return a.diff(e,t,n)},e.diffLines=c,e.diffTrimmedLines=function(e,t,n){var i=o(n,{ignoreWhitespace:!0});return u.diff(e,t,i)},e.diffSentences=function(e,t,n){return d.diff(e,t,n)},e.diffCss=function(e,t,n){return f.diff(e,t,n)},e.diffJson=function(e,t,n){return v.diff(e,t,n)},e.diffArrays=function(e,t,n){return m.diff(e,t,n)},e.structuredPatch=S,e.createTwoFilesPatch=L,e.createPatch=function(e,t,n,i,r,o){return L(e,e,t,n,i,r,o)},e.applyPatch=x,e.applyPatches=function(e,t){"string"==typeof e&&(e=w(e));var n=0;!function i(){var r=e[n++];if(!r)return t.complete();t.loadFile(r,function(e,n){if(e)return t.complete(e);var o=x(n,r,t);t.patched(r,o,function(e){if(e)return t.complete(e);i()})})}()},e.parsePatch=w,e.merge=function(e,t,n){e=C(e,n),t=C(t,n);var i={};(e.index||t.index)&&(i.index=e.index||t.index),(e.newFileName||t.newFileName)&&(P(e)?P(t)?(i.oldFileName=M(i,e.oldFileName,t.oldFileName),i.newFileName=M(i,e.newFileName,t.newFileName),i.oldHeader=M(i,e.oldHeader,t.oldHeader),i.newHeader=M(i,e.newHeader,t.newHeader)):(i.oldFileName=e.oldFileName,i.newFileName=e.newFileName,i.oldHeader=e.oldHeader,i.newHeader=e.newHeader):(i.oldFileName=t.oldFileName||e.oldFileName,i.newFileName=t.newFileName||e.newFileName,i.oldHeader=t.oldHeader||e.oldHeader,i.newHeader=t.newHeader||e.newHeader)),i.hunks=[];for(var r=0,o=0,s=0,l=0;r<e.hunks.length||o<t.hunks.length;){var a=e.hunks[r]||{oldStart:1/0},u=t.hunks[o]||{oldStart:1/0};if(O(a,u))i.hunks.push(A(a,s)),r++,l+=a.newLines-a.oldLines;else if(O(u,a))i.hunks.push(A(u,l)),o++,s+=u.newLines-u.oldLines;else{var c={oldStart:Math.min(a.oldStart,u.oldStart),oldLines:0,newStart:Math.min(a.newStart+s,u.oldStart+l),newLines:0,lines:[]};F(c,a.oldStart,a.lines,u.oldStart,u.lines),o++,r++,i.hunks.push(c)}}return i},e.convertChangesToDMP=function(e){for(var t,n=[],i=0;i<e.length;i++)n.push([(t=e[i]).added?1:t.removed?-1:0,t.value]);return n},e.convertChangesToXML=function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];i.added?t.push("<ins>"):i.removed&&t.push("<del>"),t.push(i.value.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")),i.added?t.push("</ins>"):i.removed&&t.push("</del>")}return t.join("")},e.canonicalize=b,Object.defineProperty(e,"__esModule",{value:!0})}(t)}}]);